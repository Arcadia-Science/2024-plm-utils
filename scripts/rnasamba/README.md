# Training and evaluating RNASamba models
This directory contains a script that train and evaluates RNASamba models on the datasets generated by the `plmutils.tasks.orf_prediction` module.

This script is not a module of the main `plmutils` package and indeed it cannot be run in the same environment as the main package because RNASamba depends on tensorflow 1.15 while `plmutils` depends on pytorch 2.2.

To set up the environment to run this script, first create a new env from the `rnasamba.yml` file:
```bash
mamba env create -n rnasamba-env -f envs/rnasamba.yml
```
Note that the `envs/` directory is relative to the root of the repository.

Then activate the environment:
```bash
conda activate rnasamba-env
```

Then install the `rnasamba` package manually:
```bash
pip install --no-deps rnasamba==0.2.5
```
The `rnasamba` package must be installed manually because there is no way to specify the `--no-deps` flag in the `rnasamba.yml` file, and the direct deps of `rnasamba` include the original "version" of tensorflow 1.15, which is incompatible with CUDA 12. The virtualenv above installs a fork of tensorflow 1.15 maintained by nvidia that is compatible with CUDA 12.
